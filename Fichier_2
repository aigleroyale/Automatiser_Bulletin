def base_moyenne(chemin, nom_fichier, Nclass):
    
    # initialisation de la variable liste 
    
    ETUDIANT = []
    
    # boucle pour entrer le nom des etudiants
    
    for i in range(Nclass):
        print("Quel est le nom de l'étudiant ? "+str(i+1)+": ")
        NOM = input()
        ETUDIANT.append(NOM)
    
    # initialisation des variables des matières
    
    ECONOMIE = np.array([])
    MATHEMATIQUE = np.array([])
    PROJET = np.array([])
    
    # boucle pour entrer les données
    
    for p in ETUDIANT:
        print('Entrer la moyenne en economie de '+p)
        eco = int(input())
    
        print('Entrer la moyenne en mathématique de '+p)
        math = int(input())
    
        print('Entrer la moyenne en projet de '+p)
        proj = int(input())
    
        ECONOMIE = np.append(ECONOMIE, eco)
        MATHEMATIQUE = np.append(MATHEMATIQUE, math)
        PROJET = np.append(PROJET, proj)
    
    # dictionnaire de données pour generer notre base de donnees
    data = { 
            "NOM_PRENOM" : np.array(ETUDIANT),
            "ECONOMIE" : np.array(ECONOMIE),
            "MATHEMATIQUE" : np.array(MATHEMATIQUE),
            "PROJET" : np.array(PROJET),
            }
    
    DF1 = pd.DataFrame.from_dict(data)
    
    # calcul de la moyenne
    
    M = DF1.mean(axis = 1)
    M = round(M,2)
    DF2= DF1.assign(MOYENNE = M)
    DF2

    R = DF2.MOYENNE.rank(ascending = False)
    RANGS = round(R,0)
    
    # calcul du rang et classement
    
    DF = DF2.assign(RANG = RANGS)
    DF[['RANG']].astype(int)
    DF.sort_values(by=['RANG'], inplace = True)
    DF
    
    # sauvegarder en excel
    DF.to_excel(chemin+ "/" + nom_fichier + ".xlsx",  index=False)
    return DF
