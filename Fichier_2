# pip install pyttsx3
# nous importons les packages ici
import numpy as np
import pandas as pd

# tkinter va nous permettre d'ouvrir une fenetre de dialogue
# afin de choisir nos fiches de données

from tkinter.filedialog import askopenfilename
from tkinter import Tk

# nous avons 
def automate(chemin, nom_fichier):
    root = Tk()
    root.withdraw()
    liste = []

    n = int(input('entrer le nombre de matières : '))
    for i in range(n):
        filename = askopenfilename(title="CSV ?")
        base = pd.read_excel(filename)
        liste.append(base)
    
    listes = liste
    first = listes[0]

    for j in listes:
        BASE = first.merge(j)
        first = BASE
        BASES = first
    
    #BASES.index = BASES['NOM']
    #BASES = BASES.drop(['NOM'], axis = 1)
    
    M = BASES.mean(axis = 1)
    M = round(M,2)
    DF2= BASES.assign(MOYENNE = M)
    DF2
    
    R = DF2.MOYENNE.rank(ascending = False)
    RANGS = list(R)
    DF = DF2.assign(RANG = RANGS)
    DF.sort_values(by=['RANG'], inplace = True)
    DF
    DF.to_excel(chemin+ "/" + nom_fichier + ".xlsx",  index=False)

    print(DF)
