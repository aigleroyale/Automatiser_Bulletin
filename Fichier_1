# Part 1 : creer un fichier excel
# pip install pyttsx3
# nous importons les packages ici
import numpy as np
import pandas as pd

# tkinter permet de faire des interfaces graphiques
#tkinter va nous permettre d'ouvrir une fenetre de dialogue
# afin de choisir nos fiches de donnees

from tkinter.filedialog import askopenfilename
from tkinter import Tk

# automate est permet de nommer et d'enregistrer nos fichiers
def automate(chemin, nom_fichier):
    # afficher la fenetre de dialogue
    root = Tk()
    root.withdraw()
    # une liste de l'ensemble des fichiers importés
    liste = []
    #
    # quel est le nombre de matières à importer ?
    n = int(input('entrer le nombre de matières : '))
    # permet d'importer chaque matière
    for i in range(n):
        filename = askopenfilename(title="importe ton ficher ")
        base = pd.read_excel(filename)
        liste.append(base)
    
    listes = liste
    first = listes[0]
    # fusion des bases de données
    for j in listes:
        BASE = first.merge(j)
        first = BASE
        BASES = first
    
    #BASES.index = BASES['NOM']
    #BASES = BASES.drop(['NOM'], axis = 1)
    # calcul de la moyenne
    M = BASES.mean(axis = 1)
    M = round(M,2)
    DF2= BASES.assign(MOYENNE = M)
    DF2
    
    # fais un classement par ordre croissant
    
    R = DF2.MOYENNE.rank(ascending = False)
    RANGS = list(R)
    
    # calculer le rang
    
    DF = DF2.assign(RANG = RANGS)
    DF.sort_values(by=['RANG'], inplace = True)
    DF
    
    # sauvegarder en excel
    DF.to_excel(chemin+ "/" + nom_fichier + ".xlsx",  index=False)

    return DF
